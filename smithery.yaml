runtime: "container"
build:
  dockerfile: "Dockerfile"
  dockerBuildPath: "."

startCommand:
  type: "http"
  containerPort: 8000
  healthCheckPath: "/health"
  mcpEndpoint: "/mcp"  # ✅ Specify MCP endpoint
  command:
    - "/entrypoint.sh"
    - "http"
  
  configSchema:
    type: "object"
    properties:
      # ✅ Remove apiKey requirement for MCP access
      NEO4J_URI:
        type: "string"
        description: "Neo4j connection URI (use embedded for testing)"
        default: "bolt://neo4j:7687"
      NEO4J_USER:
        type: "string"
        description: "Neo4j username"
        default: "neo4j"
      NEO4J_PASSWORD:
        type: "string"
        description: "Neo4j password"
        default: "password"
      NEO4J_DATABASE:
        type: "string"
        description: "Neo4j database name"
        default: "neo4j"
      BASIC_AUTH_USER:
        type: "string"
        description: "Admin dashboard username"
        default: "admin"
      BASIC_AUTH_PASS:
        type: "string"
        description: "Admin dashboard password"
        default: "changeme"
      PORT:
        type: "integer"
        description: "HTTP server port"
        default: 8000
    required:
      - NEO4J_URI
      - NEO4J_USER
      - NEO4J_PASSWORD

  exampleConfig:
    NEO4J_URI: "bolt://neo4j:7687"
    NEO4J_USER: "neo4j"
    NEO4J_PASSWORD: "password"
    NEO4J_DATABASE: "neo4j"
    BASIC_AUTH_USER: "admin"
    BASIC_AUTH_PASS: "changeme"
    PORT: 8000

# ✅ Properly define MCP tools
tools:
  - name: "asr_got.query"
    description: "Execute an Adaptive Graph of Thoughts reasoning query for complex scientific problems"
    inputSchema:
      type: "object"
      properties:
        query:
          type: "string"
          description: "The scientific question or problem to analyze"
        parameters:
          type: "object"
          properties:
            include_reasoning_trace:
              type: "boolean"
              default: true
            include_graph_state:
              type: "boolean"
              default: false
      required: ["query"]

# Enhanced configuration schema
configSchema:
  type: "object"
  properties:
    NEO4J_URI:
      type: "string"
      description: "Neo4j connection URI"
      default: "bolt://neo4j:7687"
    NEO4J_USER:
      type: "string"
      description: "Neo4j username"
      default: "neo4j"
    NEO4J_PASSWORD:
      type: "string"
      description: "Neo4j password"
      default: "password"
    NEO4J_DATABASE:
      type: "string"
      description: "Neo4j database name"
      default: "neo4j"
    ENABLE_EVIDENCE_SOURCES:
      type: "boolean"
      description: "Enable external evidence sources (PubMed, Scholar)"
      default: true
    MAX_REASONING_DEPTH:
      type: "integer"
      description: "Maximum reasoning depth for graph analysis"
      default: 5
      minimum: 1
      maximum: 10
    CONFIDENCE_THRESHOLD:
      type: "number"
      description: "Minimum confidence threshold for results"
      default: 0.7
      minimum: 0.0
      maximum: 1.0
  required:
    - NEO4J_URI
    - NEO4J_USER
    - NEO4J_PASSWORD
